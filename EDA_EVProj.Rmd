---
title: "LAs BEST Project"
author: "Justin Coles"
date: "2025-06-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
getwd()
EV_data <- read.csv("data_ZEV_asthmaED_2013_2022.csv")
EV_data <- read.csv("./Data/data_ZEV_asthmaED_2013_2022.csv")
```

```{r}
#Getting number of EVs per 1000 people
EV_data$nZEV1000pop <- EV_data$nZEV/EV_data$pop *1000
#RoA = Rate of Asthma
log_AgeAdj_RoA_ED_Visit_Rate <- log(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)
#Getting LN to help create better plots 
```

```{r}
#Summary Stats by all years
summary_stats_allyrs <- c(
summary(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate),
SD=sd(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate))
#mean(41.90) --> #there are about 41.90 visits to ED per 10,000ppl
#Sd(28.98) --> there is huge variance between zip codes and ppl in ED 
```

```{r}
#Summary Stats by each years
cat("Summary Statistics of Asthma ED Visit Rates by Year:\n")
print(tapply(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate, EV_data$yr, summary, na.rm = TRUE))

cat("\nStandard Deviation by Year:\n")
print(tapply(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate , EV_data$yr , sd, na.rm = TRUE))

```

```{r}
tapply(EV_data$nZEV, EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$nZEV, EV_data$yr, sd,      na.rm = TRUE)

```
```{r}
tapply(EV_data$nZEV1000pop , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$nZEV1000pop , EV_data$yr, sd,      na.rm = TRUE)
```
```{r} 
tapply(EV_data$pop , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$pop , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$percPoverty , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$percPoverty , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$HHincomeMedian , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$HHincomeMedian , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$HHincomeMean , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$HHincomeMean , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$EDUCpercHSplus , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$EDUCpercHSplus , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$EDUCpercBAplus , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$EDUCpercBAplus , EV_data$yr, sd,      na.rm = TRUE)
```
```{r}

#New dataset with just the variables of interest for Corr. Matrix

library(corrplot)

corr_EV_data_vars <- EV_data[, c(
  "nZEV",                      # number of electric vehicles
  "nZEV1000pop",              # EVs per 1000 people (you created this)
  "pop",                      # population
  "Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate",  # asthma outcome
  "percPoverty",              # poverty %
  "HHincomeMedian",           # median income
  "HHincomeMean",             # mean income
  "EDUCpercHSplus",           # % with high school education or higher
  "EDUCpercBAplus"            # % with bachelorâ€™s degree or higher
)]

corr_EV_data_matrix <- cor(corr_EV_data_vars, use = "complete.obs")
print(corr_EV_data_matrix)


```

```{r}
par(mfrow = c(1,3))
#Histograms of RoA, ZEVs, Population
hist(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate, main = 'Rate of Asthma', xlab = 'Age Adjusted Rate of Asthma')
hist(EV_data$nZEV, main ='Zero Emission Vehicles', xlab = '# of Zero Emission Vehicles')
hist(EV_data$pop, main ='Population', xlab = 'Population Count')
```

```{r}
#Histograms of Poverty rate, Median Income, Mean Income
par(mfrow = c(1,3))

hist(EV_data$percPoverty, main = 'Poverty Rate', xlab = 'Percent of Poverty')
hist(EV_data$HHincomeMedian, main ='Median Income', xlab = 'Annual Income')
hist(EV_data$HHincomeMean, main ='Mean Income', xlab = 'Annual Income')
```

```{r}
par(mfrow = c(1,2))
#Histograms of HS Education, BA Education
hist(EV_data$EDUCpercHSplus, main = 'HS Education', xlab = '% of 25+ w/ High School Diploma')
hist(EV_data$EDUCpercBAplus, main ='BA Education', xlab = "% of 25+ w/ Bachelor's Degree")
```

```{r}
library(ggplot2)
EV_data <- within(EV_data, {
  yr <- factor(yr)
  zip <- factor(zip)
  ED <- EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate
})

require(ggplot2)
p <- ggplot(data = EV_data, aes(x = yr, y = ED ,group = zip))
p + geom_point() + geom_line()
scale_y_continuous((breaks = seq(0, 8000, by = 1000)))
```

```{r}
#t-test 
data1 = c(EV_data$nZEV)
result1 = t.test(data1, alternative ="two.sided", conf.level = 0.95)
result1$conf.int
result1

data2 = c(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)
result2 = t.test(data2, alternative ="two.sided", conf.level = 0.95)
result2$conf.int
result2
sdnZEV = sd(EV_data$nZEV)
sdRoA = sd(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)

sdnZEV
sdRoA
```


