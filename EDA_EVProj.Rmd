---
title: "LAs BEST Project"
author: "Justin Coles"
date: "2025-06-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
getwd()
EV_data <- read.csv("./Data/data_ZEV_asthmaED_2013_2022.csv")
```

```{r}
#Getting number of EVs per 1000 people
EV_data$nZEV1000pop <- EV_data$nZEV/EV_data$pop *1000
#RoA = Rate of Asthma
log_AgeAdj_RoA_ED_Visit_Rate <- log(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)
#Getting LN to help create better plots 
```

```{r}
#Summary Stats by all years
summary_stats_allyrs <- c(
summary(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate),
SD=sd(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate))
#mean(41.90) --> #there are about 41.90 visits to ED per 10,000ppl
#Sd(28.98) --> there is huge variance between zip codes and ppl in ED 
```

```{r}
#Summary Stats by each years
cat("Summary Statistics of Asthma ED Visit Rates by Year:\n")
print(tapply(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate, EV_data$yr, summary, na.rm = TRUE))

cat("\nStandard Deviation by Year:\n")
print(tapply(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate , EV_data$yr , sd, na.rm = TRUE))

```

```{r}
tapply(EV_data$nZEV, EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$nZEV, EV_data$yr, sd,      na.rm = TRUE)

```
```{r}
tapply(EV_data$nZEV1000pop , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$nZEV1000pop , EV_data$yr, sd,      na.rm = TRUE)
```
```{r} 
tapply(EV_data$pop , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$pop , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$percPoverty , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$percPoverty , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$HHincomeMedian , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$HHincomeMedian , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$HHincomeMean , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$HHincomeMean , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$EDUCpercHSplus , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$EDUCpercHSplus , EV_data$yr, sd,      na.rm = TRUE)
```

```{r}
tapply(EV_data$EDUCpercBAplus , EV_data$yr, summary, na.rm = TRUE) 
tapply(EV_data$EDUCpercBAplus , EV_data$yr, sd,      na.rm = TRUE)
```
```{r}

#New dataset with just the variables of interest for Corr. Matrix

library(corrplot)

corr_EV_data_vars <- EV_data[, c(
  "nZEV",                      # number of electric vehicles
  "nZEV1000pop",              # EVs per 1000 people (you created this)
  "pop",                      # population
  "Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate",  # asthma outcome
  "percPoverty",              # poverty %
  "HHincomeMedian",           # median income
  "HHincomeMean",             # mean income
  "EDUCpercHSplus",           # % with high school education or higher
  "EDUCpercBAplus"            # % with bachelorâ€™s degree or higher
)]

corr_EV_data_matrix <- cor(corr_EV_data_vars, use = "complete.obs")
print(corr_EV_data_matrix)


```
```{r}
##spaghetti plot
EV_data$nZEV <- as.numeric(as.character(EV_data$nZEV))
EV_data_100$nZEV <- as.numeric(as.character(EV_data_100$nZEV))
zip <- unique(EV_data$zip)
set.seed(99)
zip100 <- sample(zip,100)
EV_data_100 = EV_data[EV_data$zip %in% zip100, ]
?ggplot2

p <- ggplot(data = EV_data_100, aes(x = yr, y = nZEV, group = zip)) + 
  geom_point() + 
  geom_line() + 
  ggtitle("100 Randomly Selected ZipCodes") +
  xlab("Year") + 
  ylab("Number of Zero Emission Vehicles") + 
  
  scale_y_continuous(breaks = seq(0, 5000, by = 1200) 
)
p

```

