---
title: "Regression"
author: "Justin Coles,Jessy Garcia, Joseph Salamante"
date: "2025-06-30"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```
```{r}
library(ggplot2)
library(dplyr) 
getwd()
EV_data <- read.csv("./Data/data_ZEV_asthmaED_2013_2022.csv")
# Income vs. Log Asthma Rate Plot
# For 2013
EV_data$nZEV1000pop <- EV_data$nZEV/EV_data$pop *1000
EV_data$log_AgeAdj_RoA_ED_Visit_Rate <- log(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)
EV_data_2013 <- EV_data %>% filter( yr == 2013)
EV_data_2022 <- EV_data %>% filter( yr == 2022)
```


```{r}
library(ggplot2)
library(dplyr) 
getwd()
EV_data <- read.csv("./Data/data_ZEV_asthmaED_2013_2022.csv")
# Income vs. Log Asthma Rate Plot
# For 2013
EV_data$nZEV1000pop <- EV_data$nZEV/EV_data$pop *1000
EV_data$log_AgeAdj_RoA_ED_Visit_Rate <- log(EV_data$Age_Adjusted_Rate_of_Asthma_ED_Visit_Rate)
EV_data_2013 <- EV_data %>% filter( yr == 2013)
EV_data_2022 <- EV_data %>% filter( yr == 2022)
```

```{r}

ggplot(EV_data_2013, aes(x = HHincomeMedian, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "blue") +
  labs(
    title = "2013: Median Income vs Log Asthma ED Visit Rate",
    x = "Median Household Income ($)",
    y = "Log Asthma ED Visit Rate"
  )
```

```{r}

# For 2022
ggplot(EV_data_2022, aes(x = HHincomeMedian, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "darkgreen") +
  labs(
    title = "2022: Median Income vs Log Asthma ED Visit Rate",
    x = "Median Household Income ($)",
    y = "Log Asthma ED Visit Rate"
  )

```

```{r}

lm(EV_data_2013$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2013$percPoverty   , data = EV_data)
lm(EV_data_2022$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2022$percPoverty, data = EV_data)

#Poverty Percentage vs Log Asthma Rate
# 2013
ggplot(EV_data_2013, aes(x = percPoverty, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "red") +
  labs(
    title = "2013: Poverty % vs Log Asthma ED Visit Rate",
    x = "% Below Poverty Line",
    y = "Log Asthma ED Visit Rate"
  )

# 2022
ggplot(EV_data_2022, aes(x = percPoverty, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "purple") +
  labs(
    title = "2022: Poverty % vs Log Asthma ED Visit Rate",
    x = "% Below Poverty Line",
    y = "Log Asthma ED Visit Rate"
  )


```

```{r}
 
EV_data_2013 <- EV_data %>%
  filter( yr == 2013)
lm(EV_data_2013$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2013$EDUCpercBAplus   , data = EV_data)
EV_data_2022 <- EV_data %>%
  filter( yr == 2022)
lm(EV_data_2022$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2022$EDUCpercBAplus, data = EV_data)

#BA Education vs Log Asthma Rate 
# 2013
ggplot(EV_data_2013, aes(x = EDUCpercBAplus, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "orange") +
  labs(
    title = "2013: % with BA+ vs Log Asthma ED Visit Rate",
    x = "% with Bachelor's or Higher",
    y = "Log Asthma ED Visit Rate"
  )

# 2022
ggplot(EV_data_2022, aes(x = EDUCpercBAplus, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "darkorange") +
  labs(
    title = "2022: % with BA+ vs Log Asthma ED Visit Rate",
    x = "% with Bachelor's or Higher",
    y = "Log Asthma ED Visit Rate"
  )

```

```{r}
EV_data_2013 <- EV_data %>%
  filter( yr == 2013)
lm(EV_data_2013$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2013$nZEV1000pop   , data = EV_data)
EV_data_2022 <- EV_data %>%
  filter( yr == 2022)
lm(EV_data_2022$log_AgeAdj_RoA_ED_Visit_Rate ~ EV_data_2022$nZEV1000pop , data = EV_data)

# ZEVs per 1,000 vs Log Asthma
# 2013
ggplot(EV_data_2013, aes(x = nZEV1000pop, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "steelblue") +
  labs(
    title = "2013: ZEVs per 1,000 People vs Log Asthma Rate",
    x = "ZEVs per 1,000 People",
    y = "Log Asthma ED Visit Rate"
  )

# 2022
ggplot(EV_data_2022, aes(x = nZEV1000pop, y = log_AgeAdj_RoA_ED_Visit_Rate)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", color = "forestgreen") +
  labs(
    title = "2022: ZEVs per 1,000 People vs Log Asthma Rate",
    x = "ZEVs per 1,000 People",
    y = "Log Asthma ED Visit Rate"
  )


```

```{r}
#Mutli Linear Regression Model 2022

multi_model_2022_poverty <- lm(log_AgeAdj_RoA_ED_Visit_Rate ~ I(nZEV1000pop/10)   +  percPoverty, data= EV_data_2022)

exp(-0.093791) 

(1- 0.910473) *100
```



```{r}
#Mutli Linear Regression Model 2022 No SES

multi_model_2022 <- lm(log_AgeAdj_RoA_ED_Visit_Rate ~ I(nZEV1000pop/10), data= EV_data_2022)

summary(multi_model_2022)

exp(-0.128381)

(1 - 0.8795182) * 100
```

